<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>さじグラム</title>
  <style>
    /* Rosé Pine */
    :root {
      --base:    #191724;
      --surface: #1f1d2e;
      --overlay: #26233a;
      --muted:   #6e6a86;
      --subtle:  #908caa;
      --text:    #e0def4;
      --love:    #eb6f92;
      --gold:    #f6c177;
      --rose:    #ebbcba;
      --hl-med:  #403d52;
      --hl-high: #524f67;
    }

    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', sans-serif;
      background: var(--base);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 20px 16px;
    }

    .container {
      width: 100%;
      max-width: 440px;
      background: var(--surface);
      border-radius: 20px;
      overflow: hidden;
    }

    .input-section {
      padding: 28px 24px 20px;
    }

    h1 {
      font-size: 1.4rem;
      font-weight: 800;
      color: var(--rose);
      margin-bottom: 24px;
      letter-spacing: 0.04em;
    }

    .field {
      margin-bottom: 20px;
    }

    .field-label {
      display: block;
      font-size: 0.68rem;
      font-weight: 700;
      color: var(--muted);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      margin-bottom: 8px;
    }

    /* トグル */
    .toggle-group {
      display: flex;
      gap: 8px;
    }

    .toggle-label {
      flex: 1;
      cursor: pointer;
    }

    .toggle-label input[type="radio"] {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 48px;
      border: 2px solid var(--hl-med);
      border-radius: 10px;
      font-size: 1rem;
      font-weight: 600;
      color: var(--subtle);
      background: var(--overlay);
      transition: border-color 0.15s, background 0.15s, color 0.15s;
      user-select: none;
    }

    .toggle-label input[type="radio"]:checked + .toggle-btn {
      border-color: var(--love);
      background: rgba(235, 111, 146, 0.12);
      color: var(--love);
    }

    .toggle-label input[type="radio"]:focus-visible + .toggle-btn {
      outline: 2px solid var(--love);
      outline-offset: 2px;
    }

    /* セレクト */
    select {
      appearance: none;
      -webkit-appearance: none;
      background-color: var(--overlay);
      border: 2px solid var(--hl-med);
      border-radius: 10px;
      padding: 11px 32px 11px 12px;
      font-size: 1rem;
      font-family: inherit;
      color: var(--text);
      cursor: pointer;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1.5l5 5 5-5' stroke='%236e6a86' stroke-width='1.8' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
      min-height: 48px;
      transition: border-color 0.15s;
    }

    select:focus {
      outline: none;
      border-color: var(--love);
    }

    select:disabled {
      opacity: 0.3;
      cursor: default;
    }

    /* 分量行 */
    .amount-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .amount-row .sep {
      color: var(--muted);
      font-size: 0.95rem;
      white-space: nowrap;
    }

    #integer     { width: 74px; }
    #numerator   { width: 74px; }
    #denominator { width: 74px; }

    /* 結果エリア */
    .result-section {
      border-top: 1px solid var(--hl-med);
    }

    .result-header {
      padding: 14px 24px 10px;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--subtle);
      letter-spacing: 0.06em;
    }

    .ingredient-list {
      list-style: none;
      padding-bottom: 16px;
    }

    .ingredient-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 11px 24px;
      border-top: 1px solid var(--hl-med);
    }

    .ingredient-name {
      font-size: 1rem;
      color: var(--text);
    }

    .ingredient-grams {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--gold);
      letter-spacing: -0.01em;
      min-width: 64px;
      text-align: right;
    }

    .group-sep {
      height: 1px;
      background: var(--hl-high);
      margin: 4px 24px;
      list-style: none;
    }

    @media (max-width: 360px) {
      .amount-row { flex-wrap: wrap; gap: 4px; }
      #integer, #numerator, #denominator { width: 68px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="input-section">
      <h1>さじグラム</h1>

      <!-- さじ種別: 小さじ→大さじ、小さじデフォルト -->
      <div class="field">
        <span class="field-label">さじ種別</span>
        <div class="toggle-group" role="group" aria-label="さじ種別">
          <label class="toggle-label">
            <input type="radio" name="spoon" value="teaspoon" checked>
            <span class="toggle-btn">小さじ</span>
          </label>
          <label class="toggle-label">
            <input type="radio" name="spoon" value="tablespoon">
            <span class="toggle-btn">大さじ</span>
          </label>
        </div>
      </div>

      <!-- 分量 -->
      <div class="field">
        <span class="field-label">分量</span>
        <div class="amount-row">
          <select id="integer" aria-label="整数部"></select>
          <span class="sep">と</span>
          <select id="numerator" aria-label="端数の分子"></select>
          <span class="sep">/</span>
          <select id="denominator" aria-label="端数の分母"></select>
        </div>
      </div>
    </div>

    <!-- 結果: 全調味料一覧 -->
    <div class="result-section" aria-live="polite">
      <div class="result-header" id="result-header"></div>
      <ul class="ingredient-list" id="ingredient-list"></ul>
    </div>
  </div>

  <script>
    const groups = [
      { gramPerTablespoon: 15, items: ["水", "酒", "酢"] },
      { gramPerTablespoon: 18, items: ["みりん", "しょうゆ", "塩"] },
      { gramPerTablespoon:  9, items: ["小麦粉", "片栗粉"] },
    ];

    const integerSel     = document.getElementById("integer");
    const numeratorSel   = document.getElementById("numerator");
    const denominatorSel = document.getElementById("denominator");
    const resultHeader   = document.getElementById("result-header");
    const ingredientList = document.getElementById("ingredient-list");

    // セレクト構築
    for (let i = 0; i <= 9; i++) {
      const opt = new Option(i, i);
      if (i === 1) opt.selected = true;
      integerSel.appendChild(opt);
    }
    for (let i = 0; i <= 5; i++) numeratorSel.appendChild(new Option(i, i));
    for (let i = 1; i <= 5; i++) denominatorSel.appendChild(new Option(i, i));

    // 調味料リストDOM構築（初回のみ）
    groups.forEach((grp, gi) => {
      if (gi > 0) {
        const sep = document.createElement("li");
        sep.className = "group-sep";
        sep.setAttribute("role", "separator");
        ingredientList.appendChild(sep);
      }
      grp.items.forEach(name => {
        const li = document.createElement("li");
        li.className = "ingredient-row";
        li.innerHTML = `<span class="ingredient-name">${name}</span><span class="ingredient-grams" data-name="${name}"></span>`;
        ingredientList.appendChild(li);
      });
    });

    function syncDenominator() {
      denominatorSel.disabled = (parseInt(numeratorSel.value, 10) === 0);
    }

    function calculate() {
      const intPart   = parseInt(integerSel.value, 10);
      const num       = parseInt(numeratorSel.value, 10);
      const den       = parseInt(denominatorSel.value, 10);
      const isTable   = document.querySelector('input[name="spoon"]:checked').value === "tablespoon";
      const fraction  = num === 0 ? 0 : num / den;
      const amount    = intPart + fraction;
      const spoonCoef = isTable ? 1 : (1 / 3);

      // ヘッダーテキスト
      let amountStr;
      if (num === 0) {
        amountStr = String(intPart);
      } else if (intPart === 0) {
        amountStr = `${num}/${den}`;
      } else {
        amountStr = `${intPart}と${num}/${den}`;
      }
      resultHeader.textContent = `${isTable ? "大さじ" : "小さじ"}${amountStr}`;

      // 各グループのグラムを更新
      groups.forEach(grp => {
        const grams = parseFloat((amount * spoonCoef * grp.gramPerTablespoon).toFixed(2));
        grp.items.forEach(name => {
          document.querySelector(`[data-name="${name}"]`).textContent = `${grams}g`;
        });
      });
    }

    integerSel.addEventListener("change", calculate);
    numeratorSel.addEventListener("change", () => { syncDenominator(); calculate(); });
    denominatorSel.addEventListener("change", calculate);
    document.querySelectorAll('input[name="spoon"]').forEach(r =>
      r.addEventListener("change", calculate)
    );

    syncDenominator();
    calculate();
  </script>
</body>
</html>
